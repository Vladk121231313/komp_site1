{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>{% block title %}–ú–æ–π –°–∞–π—Ç{% endblock title %}</title> 
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
     
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    
    <style>
        .header-grid {
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            /* üí° –ù–û–í–û–ï: –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–ø—Ä–µ—â–∞–µ–º –ø–µ—Ä–µ–Ω–æ—Å, –¥–ª—è –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
            flex-wrap: nowrap; 
        }   
        
        /* üí° –ù–û–í–´–ô –ë–õ–û–ö: –î–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –õ–æ–≥–æ + –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .header-left {
            display: flex;
            align-items: center; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ª–æ–≥–æ—Ç–∏–ø –∏ —Å—Å—ã–ª–∫–∏ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
            /* –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –º–µ–∂–¥—É –ª–æ–≥–æ –∏ —Å—Å—ã–ª–∫–∞–º–∏ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –æ—Ç—Å—Ç—É–ø */
            gap: 1.5rem; 
        }
        
        .header-logo h2 {
            /* –£–±–∏—Ä–∞–µ–º –Ω–∏–∂–Ω–∏–π margin, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Å–¥–≤–∏–Ω—É—Ç—å –ª–æ–≥–æ—Ç–∏–ø */
            margin-bottom: 0;
            /* –î–µ–ª–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã–º –∏ –∑–∞–º–µ—Ç–Ω—ã–º */
            font-weight: 700;
            font-size: 1.8rem;
            flex-shrink: 0;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Å—ã–ª–æ–∫: —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã, —á—Ç–æ–±—ã –æ–Ω–∏ –±—ã–ª–∏ –≤–ø–ª–æ—Ç–Ω—É—é –∫ –ª–æ–≥–æ—Ç–∏–ø—É */
        .header-nav .nav {
            /* –£–±–∏—Ä–∞–µ–º padding –∏ margin, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –≤ ul.nav */
            margin: 0;
            padding: 0;
        }
        .header-nav .nav-item {
            /* –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã –≤ li */
            padding: 0;
        }

        /* üí° –°–¢–ò–õ–¨ –°–°–´–õ–ö–ò: –î–µ–ª–∞–µ–º –µ–µ –ø–æ—Ö–æ–∂–µ–π –Ω–∞ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç */
        .header-nav .nav-link {
            padding: 0 0.5rem; /* –£–º–µ–Ω—å—à–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π padding */
            color: #333 !important; /* –ë–æ–ª–µ–µ —Ç–µ–º–Ω—ã–π, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ü–≤–µ—Ç */
            font-size: 1.1rem; /* –ß—É—Ç—å –±–æ–ª—å—à–µ –æ–±—ã—á–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ */
            font-weight: 500;
            transition: color 0.2s;
        }
        
        .header-nav .nav-link:hover {
            color: var(--bs-primary) !important; /* –¶–≤–µ—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        }

        .header-actions {
            /* –ü—Ä–∏–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∫ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é */
            margin-left: auto; 
        }
        @media (max-width: 991.98px) {
        
        /* 1. –û–±—â–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: –†–∞–∑—Ä–µ—à–∞–µ–º –ø–µ—Ä–µ–Ω–æ—Å –∏ –≤—ã—Å—Ç—Ä–∞–∏–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ */
        .header-grid {
            flex-direction: column; 
            align-items: flex-start; /* –ü—Ä–∏–∂–∏–º–∞–µ–º –≤—Å–µ –∫ –ª–µ–≤–æ–º—É –∫—Ä–∞—é */
            gap: 1rem; /* –î–æ–±–∞–≤–ª—è–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏ */
        }
        
        /* 2. –õ–æ–≥–æ—Ç–∏–ø –∏ –°—Å—ã–ª–∫–∏: –õ–æ–≥–æ—Ç–∏–ø –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–≤–µ—Ä—Ö—É, —Å—Å—ã–ª–∫–∏ –ø–æ–¥ –Ω–∏–º */
        .header-left {
            width: 100%;
            justify-content: space-between; /* –õ–æ–≥–æ —Å–ª–µ–≤–∞, –°—Å—ã–ª–∫–∏ —Å–ø—Ä–∞–≤–∞ (–∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç, –µ—Å–ª–∏ —ç—Ç–æ —É–º–µ—Å—Ç–Ω–æ) */
            /* üí° –ò–õ–ò: –û—Ç–∫–ª—é—á–∏–º Flexbox –¥–ª—è header-left –∏ —Ä–∞–∑–º–µ—Å—Ç–∏–º —Å—Å—ã–ª–∫–∏ –ø–æ–¥ –ª–æ–≥–æ—Ç–∏–ø–æ–º */
            /* display: block; */ 
            /* –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –õ–æ–≥–æ—Ç–∏–ø –∏ –°—Å—ã–ª–∫–∏ –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö, –æ—Å—Ç–∞–≤—å—Ç–µ flex */
        }
        
        /* 3. –î–µ–π—Å—Ç–≤–∏—è: –ü–æ–∏—Å–∫ –∏ –∫–Ω–æ–ø–∫–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–Ω–∏–º–∞—Ç—å –≤—Å—é —à–∏—Ä–∏–Ω—É */
        .header-actions {
            width: 100%; 
            margin-left: 0; /* –£–±–∏—Ä–∞–µ–º margin-left: auto */
            /* –î–µ–ª–∞–µ–º –ø–æ–∏—Å–∫ –∏ –∫–Ω–æ–ø–∫–∏ –±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º–∏ */
            flex-direction: column; 
            align-items: stretch;
        }

        /* –ü–æ–∏—Å–∫ –∏ –∫–Ω–æ–ø–∫–∏ - –∫–∞–∂–¥—ã–π –Ω–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ */
        .header-actions form {
            width: 100%;
            margin-bottom: 0.5rem !important;
        }
    }
    </style>
</head>
<body>
    <header class="p-3 mb-3 border-bottom">
        
        {# –ò–ó–ú–ï–ù–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞—Å—Ç–æ–º–Ω—É—é —Å–µ—Ç–∫—É –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è #}
        <div class="container-fluid header-grid">

            <div class="header-left">
                <div class="header-logo">
                    <a href="{% url 'catalog:index' %}" class="text-decoration-none text-dark">
                        <h2>–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫</h2>
                    </a>
                </div>
                
                {# 2. –ë–õ–û–ö: –°–°–´–õ–ö–ò #}
                <nav class="header-nav">
                    <ul class="nav">
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'catalog:index' %}">–ì–ª–∞–≤–Ω–∞—è</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'catalog:catalog_list' %}">–ö–∞—Ç–∞–ª–æ–≥</a>
                        </li>
                    </ul>
                </nav>
            </div>
                
            {# 3. –ë–õ–û–ö 3: –ö–û–†–ó–ò–ù–ê –ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ (–°–ü–†–ê–í–ê) #}
            <div class="header-actions d-flex align-items-center">

                <form action="{% url 'catalog:catalog_list' %}" method="GET" class="d-flex me-3">
                    <input class="form-control form-control-sm" 
                           type="search" 
                           placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É" 
                           aria-label="Search" 
                           name="q"
                           value="{{ request.GET.q }}">
                    <button class="btn btn-outline-secondary btn-sm ms-1" type="submit">
                        <i class="bi bi-search"></i>
                    </button>
                </form>

                {% if user.is_authenticated %}
                    {# –ö–ù–û–ü–ö–ê –ö–û–†–ó–ò–ù–´ #}
                    <a href="{% url 'orders:cart_detail' %}" class="btn btn-outline-success me-3">
                        üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ 
                        <span id="cart-quantity-display">
                            {% if cart_total_quantity > 0 %}
                                ({{ cart_total_quantity }})
                            {% endif %}
                        </span>
                    </a>
            
          
             <div class="dropdown">
                        <button class="btn btn-dark dropdown-toggle" type="button" id="userMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                            –ü—Ä–∏–≤–µ—Ç, {{ user.username }}
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenuButton">
                            <li><a class="dropdown-item" href="{% url 'orders:order_history' %}">–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</a>
                            <a class="dropdown-item" href="{% url 'orders:user_profile' %}">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</a></li>
                            
                            {% if user.is_staff %}
                                
                                <li class="nav-item">
                                    <a class="dropdown-item" href="{% url 'orders:admin_dashboard' %}">–û—Ç—á–µ—Ç—ã</a>
                                    <a class="dropdown-item" href="{% url 'orders:custom_admin' %}">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</a>
                                </li>
                            {% endif %}

                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <form id="logout-form" method="POST" action="{% url 'auth:logout' %}" class="d-inline">
                                    {% csrf_token %}
                                    <a class="dropdown-item" href="#" onclick="document.getElementById('logout-form').submit(); return false;">
                                        –í—ã–π—Ç–∏
                                    </a>
                                </form>
                            </li>
                        </ul>
                    </div>
                {% else %}
                    {# –°–û–°–¢–û–Ø–ù–ò–ï 2: –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –ù–ï –ê–í–¢–û–†–ò–ó–û–í–ê–ù #}
                    <a href="{% url 'auth:login' %}?next={{ request.path }}" class="btn btn-outline-primary me-1">–í–æ–π—Ç–∏</a>
                    <a href="{% url 'users:register' %}?next={{ request.path }}" class="btn btn-primary">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                {% endif %}
            </div>
            
        </div>
    </header>

   <main class="container {% block main_padding %}py-5{% endblock main_padding %}"> 
        
        {% block content %}
        {% endblock content %}
        
    </main>

    <footer class="bg-dark text-white pt-5 pb-4 ">
        <div class="container">
            <div class="row">
                
                {# –ö–û–õ–û–ù–ö–ê 1: –õ–û–ì–û–¢–ò–ü –ò –°–û–¶–ò–ê–õ–¨–ù–´–ï –°–ï–¢–ò #}
                <div class="col-md-3 mb-4">
                    <h5 class="text-primary">"–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫"</h5>
                    <p class="small text-muted">
                        –í–∞—à –Ω–∞–¥–µ–∂–Ω—ã–π –ø–æ—Å—Ç–∞–≤—â–∏–∫ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏—Ö —Å 2025 –≥–æ–¥–∞.
                    </p>
                </div>

                {# –ö–û–õ–û–ù–ö–ê 2: –ë–´–°–¢–†–´–ï –°–°–´–õ–ö–ò #}
                <div class="col-md-3 mb-4">
                    <h5>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h5>
                    <ul class="list-unstyled">
                        <li><a href="{% url 'catalog:index' %}" class="text-white-50 text-decoration-none small">–ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li><a href="{% url 'catalog:catalog_list' %}" class="text-white-50 text-decoration-none small">–ö–∞—Ç–∞–ª–æ–≥</a></li>
                        {% if user.is_authenticated %}
                            <li><a href="{% url 'orders:order_history' %}" class="text-white-50 text-decoration-none small">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</a></li>
                        {% endif %}
                    </ul>
                </div>
                
                {# –ö–û–õ–û–ù–ö–ê 3 –∏ 4: –ê–ö–ö–û–†–î–ï–û–ù "–û –ù–ê–°" –∏ "–ö–û–ù–¢–ê–ö–¢–´" (–Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö) #}
                <div class="col-md-6">
                    <div class="accordion accordion-flush" id="footerAccordion">
                        
                        {# –ê–ö–ö–û–†–î–ï–û–ù 1: –û –ù–ê–° #}
                        <div class="accordion-item bg-dark border-secondary">
                            <h2 class="accordion-header" id="headingAbout">
                                <button class="accordion-button collapsed bg-dark text-white p-2" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAbout" aria-expanded="false" aria-controls="collapseAbout">
                                    –û –Ω–∞—Å
                                </button>
                            </h2>
                            <div id="collapseAbout" class="accordion-collapse collapse" aria-labelledby="headingAbout" data-bs-parent="#footerAccordion">
                                <div class="accordion-body text-white-50 small">
                                    <p>–ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–ø—Ä—è–º—É—é —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è–º–∏, —á—Ç–æ–±—ã –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–∞–º –ª—É—á—à—É—é —Ç–µ—Ö–Ω–∏–∫—É –±–µ–∑ –Ω–∞—Ü–µ–Ω–æ–∫. –ì–∞—Ä–∞–Ω—Ç–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Å–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä.</p>
                                    <p>‚úâÔ∏è support@electronik.com</p>
                                </div>
                            </div>
                        </div>

                        {# –ê–ö–ö–û–†–î–ï–û–ù 2: –ö–û–ù–¢–ê–ö–¢–´ –ò –ö–ê–†–¢–ê #}
                        <div class="accordion-item bg-dark border-secondary">
                            <h2 class="accordion-header" id="headingContacts">
                                <button class="accordion-button collapsed bg-dark text-white p-2" type="button" data-bs-toggle="collapse" data-bs-target="#collapseContacts" aria-expanded="false" aria-controls="collapseContacts">
                                    –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ö–∞—Ä—Ç–∞
                                </button>
                            </h2>
                            <div id="collapseContacts" class="accordion-collapse collapse" aria-labelledby="headingContacts" data-bs-parent="#footerAccordion">
                                <div class="accordion-body text-white-50 small">
                                    <p>üìç –≥. –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥, —É–ª. –°—Ç—Ä–æ–∫–∏–Ω–∞, –¥. 14</p>
                                    <p>üìû +7 (920) 020-04-13</p>
                                    <div class="mt-3 map-container rounded overflow-hidden">
                                        <iframe src="https://yandex.ru/map-widget/v1/?um=constructor%3Adae977b8c1d6be98e283bc73cb35f944441a2d246a4ac98a684a2516d605b6f2&amp;source=constructor" 
                                                width="100%" 
                                                height="200" 
                                                frameborder="0" 
                                                style="border: none; max-width: 100%; display: block;">
                                        </iframe>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                
            </div>
            
            <div class="row mt-4 pt-3 border-top border-secondary">
                <div class="col text-center">
                    <p class="small text-muted mb-0">&copy; 2025 "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫". –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" 
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    
    {# –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ (–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) #}
    <div class="modal fade" id="orderSuccessModal" tabindex="-1" aria-labelledby="orderSuccessModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-success text-white">
            <h5 class="modal-title" id="orderSuccessModalLabel">üéâ –£—Å–ø–µ—Ö!</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body text-center">
            <p class="lead" id="orderSuccessMessage"></p> 
            <i class="bi bi-check-circle-fill text-success" style="font-size: 3rem;"></i>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
          </div>
        </div>
      </div>
    </div>
    
    {% block custom_js %}{% endblock custom_js %}

    {# JavaScript –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ (–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) #}
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        {% if messages %}
            {% for message in messages %}
                {% if message.tags == 'success' and '—É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω' in message.message %}
                    var messageText = "{{ message.message|escapejs }}"; 
                    var myModal = new bootstrap.Modal(document.getElementById('orderSuccessModal'));
                    document.getElementById('orderSuccessMessage').innerText = messageText; 
                    myModal.show();
                {% endif %}
            {% endfor %}
        {% endif %}
    });
    </script>
</body>
</html>